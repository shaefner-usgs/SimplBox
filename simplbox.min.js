/***
* SimplBox - v1.0.0 - 2014.08.04
* Author: (c) Dendrochronology - @Dendrochronolo - http://genert.laal.ee/
* Available for use under the MIT License.
***/
!function(a,b,c){"use strict";function j(a,b){var c=this;c.m_Elements=a,c.m_UserOptions=b||{},c.m_Options={},c.m_CurrentTargetElements=f,c.m_CurrentTargetElementsLength=f,c.m_CurrentTargetNumber=f,c.m_CurrentImageElement=f,c.m_InProgress=f,c.m_InstalledImageBox=f,c.m_Alt=f,c.m_AnimateDone=f;(function(){for(var a in j.options)c.m_UserOptions.hasOwnProperty(a)?c.m_Options[a]=c.m_UserOptions[a]:c.m_Options[a]=j.options[a]})()}var d=b.documentElement,e=b.getElementsByTagName("body")[0],f=!1,g="attachEvent",h="addEventListener",i=h in b;j.prototype={init:function(){var a=this;a.API_AddEvent=a.addEvent,a.API_RemoveImageElement=a.removeImageElement,a.checkBrowser(),a.addEvents()},checkBrowser:function(){var b=this,c="ontouchstart"in a||a.navigator.msMaxTouchPoints||navigator.maxTouchPoints||f,d=c&&(a.navigator.pointerEnabled||a.navigator.msPointerEnabled);b.browser={isHardwareAccelerated:"undefined"!==b.getcss3prop("transition")?!0:f,isTouch:c,hasPointers:d}},addEvents:function(){for(var c=this,d=0;d<c.m_Elements.length;d++)!function(b){c.addEvent(c.m_Elements[b],c.browser.hasPointers?"pointerup MSPointerUp":"click",function(d){d.preventDefault&&(d.preventDefault(),d.stopPropagation()),a.event&&(a.event.returnValue=f,a.event.cancelBubble=f),c.isFunction(c.m_Options.onStart())&&c.m_Options.onStart(this),c.m_CurrentTargetElements=c.m_Elements,c.m_CurrentTargetElementsLength=c.m_Elements.length,c.m_CurrentTargetNumber=b,c.openImage(c.m_Elements[c.m_CurrentTargetNumber])})}(d);if(c.addEvent(a,"resize",function(){c.calculateImagePositionAndSize(c.m_CurrentImageElement,!0)}),c.leftAnimationFunction=function(){c.m_CurrentTargetNumber-1<0?(c.openImage(c.m_CurrentTargetElements[c.m_CurrentTargetElementsLength-1],"left"),c.m_CurrentTargetNumber=c.m_CurrentTargetElementsLength-1):(c.openImage(c.m_CurrentTargetElements[c.m_CurrentTargetNumber-1],"left"),c.m_CurrentTargetNumber=c.m_CurrentTargetNumber-1)},c.rightAnimationFunction=function(){c.m_CurrentTargetNumber+1>c.m_CurrentTargetElementsLength-1?(c.openImage(c.m_CurrentTargetElements[0],"right"),c.m_CurrentTargetNumber=0):(c.openImage(c.m_CurrentTargetElements[c.m_CurrentTargetNumber+1],"right"),c.m_CurrentTargetNumber=c.m_CurrentTargetNumber+1)},c.m_Options.enableKeyboard){var g={left:37,right:39,esc:27};c.addEvent(a,"keydown",function(b){if(c.m_CurrentImageElement&&!c.m_InProgress){if(b.preventDefault&&(b.preventDefault(),b.stopPropagation()),a.event){var b=a.event;a.event.returnValue=f,a.event.cancelBubble=f}var d=b.which||b.keyCode;switch(d){case g.esc:return c.removeImageElement(),f;case g.right:return c.rightAnimationFunction(),f;case g.left:return c.leftAnimationFunction(),f}}})}c.m_Options.quitOnDocumentClick&&c.addEvent(i?e:b,"click",function(b){if(!c.m_CurrentImageElement||c.m_InProgress)return f;if(b.preventDefault&&b.preventDefault(),a.event)var b=a.event;var d=b.target?b.target:b.srcElement;return d&&d.id!==c.m_Options.imageElementId&&c.m_InstalledImageBox&&!c.m_InProgress?(c.removeImageElement(),f):void 0})},openImage:function(c,d){var g=this,h=b.createDocumentFragment(),i=b.createElement("div"),j=b.createElement("img"),k=b.getElementById(g.m_Options.imageElementId);if(c&&"a"===c.tagName.toLowerCase()){if(k&&(e.removeChild(k),g.m_CurrentImageElement=f,g.m_InstalledImageBox=f),g.m_Alt=c.firstChild.getAttribute("alt"),g.m_InProgress=!0,g.isFunction(g.m_Options.onImageLoadStart())&&g.m_Options.onImageLoadStart(),"undefined"!=typeof d)switch(d){case"left":d=-1;break;case"right":d=1}if(i.setAttribute("id",g.m_Options.imageElementId),i.setAttribute("style","position: fixed; cursor: pointer; opacity: 0;"),j.setAttribute("src",c.getAttribute("href")),j.setAttribute("alt",g.m_Alt),i.appendChild(j),h.appendChild(i),e.appendChild(h),g.m_CurrentImageElement=b.getElementById(g.m_Options.imageElementId),g.m_CurrentImageElement.style.filter="alpha(opacity=0)",g.browser.isHardwareAccelerated&&("undefined"!=typeof d&&(g.m_CurrentImageElement.style[g.getcss3prop("transform")]="translateX("+d*g.m_Options.fadeInDistance+"px)"),g.m_CurrentImageElement.style[g.getcss3prop("transition")]="all "+g.m_Options.animationSpeed+"ms ease"),g.calculateImagePositionAndSize(g.m_CurrentImageElement,f,d),g.m_Options.quitOnImageClick&&g.addEvent(g.m_CurrentImageElement,"click",function(b){b.preventDefault&&b.preventDefault(),a.event&&(a.event.returnValue=f),g.removeImageElement()}),g.browser.isTouch){var l=-1,m=-1,n=0;g.addEvent(g.m_CurrentImageElement,"touchstart pointerdown MSPointerDown",function(a){a.preventDefault(),l=a.pageX||a.touches[0].pageX}),g.addEvent(g.m_CurrentImageElement,"touchmove pointermove MSPointerMove",function(a){a.preventDefault(),m=a.pageX||a.touches[0].pageX,n=l-m,g.browser.isHardwareAccelerated&&(g.m_CurrentImageElement.style[g.getcss3prop("transition")]="none",g.m_CurrentImageElement.style[g.getcss3prop("transform")]="translateX("+-n+"px)")}),g.addEvent(g.m_CurrentImageElement,"touchend pointerup pointercancel MSPointerUp MSPointerCancel",function(a){a.preventDefault(),Math.abs(n)>75?0>n?g.leftAnimationFunction():g.rightAnimationFunction():g.m_CurrentImageElement.style[g.getcss3prop("transform")]="translateX(0px)"})}}},calculateImagePositionAndSize:function(b,c){var k,e=this,g=new Image,h=0,i=0,j=0;b&&(k=b.querySelector("img"),e.m_ImageSource=k.getAttribute("src"),e.m_ScreenHeight=a.innerHeight||d.offsetHeight,e.m_ScreenWidth=a.innerWidth||d.offsetWidth,g.onload=function(){var a=this.width,d=this.height;h=a,i=d,j=h/i,Math.floor(e.m_ScreenWidth/j)>e.m_ScreenHeight?(h=e.m_ScreenHeight*j*e.m_Options.imageSize,i=e.m_ScreenHeight*e.m_Options.imageSize):(h=e.m_ScreenWidth*e.m_Options.imageSize,i=e.m_ScreenWidth/j*e.m_Options.imageSize),h>a&&(h=a),i>d&&(i=d),b.style.top=(e.m_ScreenHeight-i)/2+"px",b.style.left=(e.m_ScreenWidth-h)/2+"px",b.style.width=Math.floor(h)+"px",b.style.height=Math.floor(i)+"px",c||setTimeout(function(){if(e.browser.isHardwareAccelerated)b.style.opacity=1,b.style[e.getcss3prop("transform")]="translateX(0px)";else{var a=1;e.animate({delay:16,duration:e.m_Options.animationSpeed,delta:e.linear,step:function(c){b.style.opacity=a*c,b.style.filter="alpha(opacity="+a*c*100+")"}})}e.m_InProgress=f,e.m_InstalledImageBox=!0,e.isFunction(e.m_Options.onImageLoadEnd())&&e.m_Options.onImageLoadEnd(b)},100)},g.src=e.m_ImageSource)},removeImageElement:function(){var a=this;if(a.m_CurrentImageElement){if(a.isFunction(a.m_Options.onEnd())&&a.m_Options.onEnd(),a.m_InProgress&&a.isFunction(a.m_Options.onImageLoadEnd())&&a.m_Options.onImageLoadEnd(p_Element),a.browser.isHardwareAccelerated)a.m_CurrentImageElement.style.opacity=0,a.m_CurrentImageElement.style.transition="opacity 250ms ease";else{var b=0;a.animate({delay:16,duration:250,delta:a.linear,step:function(c){a.m_CurrentImageElement.style.opacity=b*c,a.m_CurrentImageElement.style.filter="alpha(opacity="+b*c*100+")"}})}setTimeout(function(){a.m_CurrentImageElement&&a.m_CurrentImageElement.parentNode.removeChild(a.m_CurrentImageElement),a.m_CurrentImageElement=f,a.m_InstalledImageBox=f},a.browser.isHardwareAccelerated?250:350)}},isFunction:function(a){return!!(a&&a.constructor&&a.call&&a.apply)},addEvent:function(c,d,e){var j,k;if(d=d.split(" "),i)if((!c||c instanceof Array&&!c.length||0===c.length)&&c!==a){if(c&&"undefined"!==c[0])for(j=0;j<c.length;j++)for(k=0;k<d.length;k++)c[j][h](d[k],e,f)}else for(j=0;j<d.length;j++)c[h](d[j],e,f);else for(j=0;j<d.length;j++)if(-1!==d[j].indexOf("keydown"))b[g]("on"+d[j],e);else if((!c||c instanceof Array&&!c.length||0===c.length)&&c!==a){if(c&&"undefined"!==c[0])for(k=0;k<c.length;k++)c[k][g](d[j],e)}else c[g]("on"+d[j],e)},animate:function(a){var b=this,c=new Date,d=setInterval(function(){var e=new Date-c,f=e/a.duration;f>1&&(f=1);var g=a.delta(f);a.step(g),1==f&&(b.m_AnimateDone=!0,clearInterval(d))},a.delay||10)},linear:function(a){return a},getcss3prop:function(a){for(var b=["","-moz-","-webkit-","-o-","-ms-","-khtml-"],c=function(a){return a.replace(/\-([a-z])/gi,function(a,b){return b.toUpperCase()})},e=0;e<b.length;e++){var f=c(b[e]+a);if("Ms"==f.substr(0,2)&&(f="m"+f.substr(1)),f in d.style)return f}return"undefined"}},j.options={imageElementId:"simplbox",fadeInDistance:100,animationSpeed:350,imageSize:.8,quitOnImageClick:!0,quitOnDocumentClick:!0,enableKeyboard:!0,onImageLoadStart:function(){},onImageLoadEnd:function(){},onStart:function(){},onEnd:function(){}},a.SimplBox=j}(window,document);
